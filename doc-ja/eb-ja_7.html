<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on December, 28  2003 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>EB Library: Subbook</TITLE>

<META NAME="description" CONTENT="EB Library: Subbook">
<META NAME="keywords" CONTENT="EB Library: Subbook">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="EN" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC29"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_6.html#SEC28"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC30"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_6.html#SEC23"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 7. 副本 </H1>
<!--docid::SEC29::-->
<P>

紙に印刷された本では別々の書籍になっているものでも、電子ブックや EPWING
では 1 枚の CD-ROM にまとめることができます。
</P><P>

たとえば、ある CD-ROM 書籍は、国語辞書、英々辞典、百科事典という 3 つ
の (印刷された本で言うところの) 「書籍」を持っていることもあり得ます。
紛らわしさを避けるために、EB ライブラリではここで言う「書籍」のことを
<EM>副本 (subbook)</EM> と呼んでいます。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>　　　ＣＤ−ＲＯＭ書籍
┌─────────────┐
│　副本０：　［国語辞典］　│
│　副本１：　［英々辞典］　│
│　副本２：　［百科事典］　│
└─────────────┘
</pre></td></tr></table></P><P>

CD-ROM 書籍では、それぞれの副本はそれ自体が独立した書籍になっています。
また、副本のデータも、副本毎に別々のファイルに収められています。
したがって、EB ライブラリでも、アプリケーションプログラムの主要な処理
である単語の検索や本文データの取得などは、すべて副本単位で行うように
なっています。
</P><P>

本章では、EB ライブラリでの副本の扱い方について説明します。
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_7.html#SEC30">7.1 副本コード</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_7.html#SEC31">7.2 選択中の副本</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_7.html#SEC32">7.3 サンプルプログラム</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_7.html#SEC33">7.4 データ型の詳細</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_7.html#SEC34">7.5 関数の詳細</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Subbook Code"></A>
<HR SIZE="6">
<A NAME="SEC30"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC31"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 7.1 副本コード </H2>
<!--docid::SEC30::-->
<P>

EB ライブラリでは、それぞれの副本に対して <EM>副本コード (subbook code)</EM>
を割り当てます。
このコードは EB ライブラリが副本を識別するために用いますので、個々の
副本コードは、書籍内で同じものがないようになっています。
</P><P>

以下のソースコードは、<CODE>eb_subbook_list()</CODE> という関数の使用例です。
この関数は、書籍内のすべての副本の副本コードを取得することができます。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>/* <CODE>book</CODE> が <CODE>EB_Book</CODE> のオブジェクトで、すでに書籍に結び付け
 * られていると仮定しています。*/
EB_Subbook_Code sub_codes[EB_MAX_SUBBOOKS];
int sub_count;

if (eb_subbook_list(&#38;book, sub_codes, &#38;sub_count)
    != EB_SUCCESS) {
    printf("eb_subbook_list() failed\n");
    return;
}
</pre></td></tr></table></P><P>

<CODE>eb_subbook_list()</CODE> が成功すると、書籍内のすべての副本コードが
配列 <CODE>sub_codes[]</CODE> に格納されます。
配列の先頭の副本コードは <CODE>sub_codes[0]</CODE> と表され、次の
コードは <CODE>sub_codes[1]</CODE>、という具合になります。
副本の個数は、<CODE>sub_count</CODE> に格納されます。
</P><P>

個々の副本には、必ず題名が付けられています。
先頭の副本 (<CODE>sub_codes[0]</CODE>) の題名は、次のようにして得ることが
できます。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>char title[EB_MAX_TITLE_LENGTH + 1];

if (eb_subbook_title2(&#38;book, sub_codes[0], title)
    != EB_SUCCESS) {
    printf("eb_subbook_title2() failed\n");
    return;
}
</pre></td></tr></table></P><P>

<CODE>eb_subbook_title2()</CODE> の呼び出しが成功すると、<CODE>title</CODE> に
題名を表す文字列が格納されます。
</P><P>

蛇足ですが、(副本ではなく) CD-ROM の題名を取得する関数はありません。
なぜなら、題名を示すデータが CD-ROM の中には何処にもないからです。
</P><P>

<A NAME="Current Subbook"></A>
<HR SIZE="6">
<A NAME="SEC31"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC30"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC32"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 7.2 選択中の副本 </H2>
<!--docid::SEC31::-->
<P>

<CODE>EB_Book</CODE> オブジェクトは、結びつけられた CD-ROM 書籍の中の任意の
副本から一つ選んで、<EM>選択中の副本 (current subbook)</EM> として指定する
ことができます。
複数の副本を、同時に選択することはできません。
単語の検索や、本文データの取得など、ほとんどの操作は、選択中の副本に
対してだけ行えます。
</P><P>

<CODE>eb_bind()</CODE> で <CODE>EB_Book</CODE> オブジェクトを書籍に結び付けた直後
は、いずれの副本も選択されていない状態になっています。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>ＥＢ＿Ｂｏｏｋ　　　　　　　　　ＣＤ−ＲＯＭ書籍
オブジェクト
┌────┐　　　　　　　┌─────────────┐
│選択中　│　　　　　　　│　副本０：　［国語辞典］　│
│の副本　│　　　　　　　│　副本１：　［英々辞典］　│
│＜なし＞│　　　　　　　│　副本２：　［百科事典］　│
└────┘　　　　　　　└─────────────┘
</pre></td></tr></table></P><P>

副本の選択を行うには、関数 <CODE>eb_set_subbook()</CODE> を使用します。
<CODE>eb_set_subbook()</CODE> は、引数として渡された副本コードにしたがって
副本を選択します。
以下は、先頭の副本 (<CODE>sub_codes[0]</CODE>) を選択する場合の例です。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>/* <CODE>book</CODE> が <CODE>EB_Book</CODE> のオブジェクトで、すでに書籍に結び付け
 * られていると仮定しています。*/
EB_Subbook_Code sub_codes[EB_MAX_SUBBOOKS];
int sub_count;

if (eb_subbook_list(&#38;book, sub_codes, &#38;sub_count)
    != EB_SUCCESS) {
    printf("eb_subbook_list() failed\n");
    return;
}
if (eb_set_subbook(&#38;book, sub_codes[0]) != EB_SUCCESS) {
    printf("eb_subbook_list() failed\n");
    return;
}
</pre></td></tr></table></P><P>

成功すると、次のように副本が選択された状態になります。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>ＥＢ＿Ｂｏｏｋ　　　　　　　　　ＣＤ−ＲＯＭ書籍
オブジェクト
┌────┐　　　　　　　┌─────────────┐
│選択中　│　　┏━━━━┿━副本０：　［国語辞典］　│
│の副本　│　　┃　　　　│　副本１：　［英々辞典］　│
│　＊━━┿━━┛　　　　│　副本２：　［百科事典］　│
└────┘　　　　　　　└─────────────┘
</pre></td></tr></table></P><P>

<A NAME="Subbook Sample"></A>
<HR SIZE="6">
<A NAME="SEC32"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC31"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC33"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 7.3 サンプルプログラム </H2>
<!--docid::SEC32::-->
<P>

<A NAME="IDX175"></A>
<TABLE><tr><td>&nbsp;</td><td class=example><pre>/*
 * 使用方法:
 *     subbook &#60;book-path&#62;
 * 例:
 *     subbook /cdrom
 * 説明:
 *     &#60;boook-path&#62; で指定され CD-ROM 書籍に含まれているすべての副本の
 *     題名を表示します。
 */
#include "config.h"

#include &#60;stdio.h&#62;
#include &#60;stdlib.h&#62;

#include &#60;eb/eb.h&#62;
#include &#60;eb/error.h&#62;

int
main(argc, argv)
    int argc;
    char *argv[];
{
    EB_Error_Code error_code;
    EB_Book book;
    EB_Subbook_Code subbook_list[EB_MAX_SUBBOOKS];
    int subbook_count;
    char title[EB_MAX_TITLE_LENGTH + 1];
    int i;

    /* コマンド行引数をチェック。*/
    if (argc != 2) {
        fprintf(stderr, "Usage: %s book-path\n", argv[0]);
        exit(1);
    }

    /* EB ライブラリと `book' を初期化。*/
    error_code = eb_initialize_library();
    if (error_code != EB_SUCCESS) {
        fprintf(stderr, "%s: failed to initialize EB Library, %s: %s\n",
            argv[0], eb_error_message(error_code), argv[1]);
        goto die;
    }
    eb_initialize_book(&#38;book);

    /* 書籍を `book' に結び付ける。*/
    error_code = eb_bind(&#38;book, argv[1]);
    if (error_code != EB_SUCCESS) {
        fprintf(stderr, "%s: failed to bind the book, %s: %s\n",
            argv[0], eb_error_message(error_code), argv[1]);
        goto die;
    }

    /* 副本の一覧を取得。*/
    error_code = eb_subbook_list(&#38;book, subbook_list, &#38;subbook_count);
    if (error_code != EB_SUCCESS) {
        fprintf(stderr, "%s: failed to get the subbbook list, %s\n",
            argv[0], eb_error_message(error_code));
        goto die;
    }

    /* 書籍に含まれている副本の題名を出力。*/
    for (i = 0; i &#60; subbook_count; i++) {
        error_code = eb_subbook_title2(&#38;book, subbook_list[i], title);
        if (error_code != EB_SUCCESS) {
            fprintf(stderr, "%s: failed to get the title, %s\n",
                argv[0], eb_error_message(error_code));
            continue;
        }
        printf("%d: %s\n", i, title);
    }

    /* 書籍と EB ライブラリの利用を終了。*/
    eb_finalize_book(&#38;book);
    eb_finalize_library();
    exit(0);

    /* エラー発生で終了するときの処理。*/
  die:
    eb_finalize_book(&#38;book);
    eb_finalize_library();
    exit(1);
}
</pre></td></tr></table></P><P>

<A NAME="Subbook Data Types"></A>
<HR SIZE="6">
<A NAME="SEC33"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC32"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC34"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 7.4 データ型の詳細 </H2>
<!--docid::SEC33::-->
<P>

この節で説明しているデータ型を使うには、次のようにヘッダファイルを
読み込んで下さい。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#include &#60;eb/eb.h&#62;
</pre></td></tr></table></P><P>

<A NAME="IDX176"></A>
<DL>
<DT><U>Data type:</U> <B>EB_Subbook_Code</B>
<DD><A NAME="IDX177"></A>
<A NAME="IDX178"></A>
</P><P>

データ型 <CODE>EB_Subbook_Code</CODE> は副本コードを表します。
一冊の書籍の中の副本は、それぞれ一意の副本コードを持っています。
この型は符合付き整数型の別名として定義されていますので、2 つのコードを
2 項演算子 <CODE>==</CODE> と <CODE>!=</CODE> で一致比較することができます。
</P><P>

また、不正な副本コード値を表す <CODE>EB_SUBBOOK_INVALID</CODE> という特別な
副本コードが定義されています。
利用可能な副本に対して、この副本コードが割り当てられることはありません。
</DL>
</P><P>

<A NAME="Subbook Functions"></A>
<HR SIZE="6">
<A NAME="SEC34"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC33"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 7.5 関数の詳細 </H2>
<!--docid::SEC34::-->
<P>

この節で説明している関数を使うには、次のようにヘッダファイルを読み込んで
下さい。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#include &#60;eb/eb.h&#62;
</pre></td></tr></table></P><P>

<A NAME="IDX179"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_load_all_subbooks</B> <I>(EB_Book *<VAR>book</VAR>)</I>
<DD><A NAME="IDX180"></A>
</P><P>

関数 <CODE>eb_load_all_subbooks()</CODE> は、<VAR>book</VAR> 内のすべての副本を
初期化します。
通常、副本の初期化は、その副本が初めて選択されたときに自動的に行われますが、
この関数は初期化を前倒しで行います。
初期化の対象となるのは、この関数を呼び出した時点でまだ初期化していない
すべての副本です。
この関数は、スタンドアロンで動作するサーバアプリケーションなどで有効です。
クライアントからの接続を受ける前にこの関数を呼ぶことで、副本の初期化の
ためにクライアントを待たせなくて済みます。
</P><P>

初期化の対象となったすべての副本の初期化に成功すれば、関数は
<CODE>EB_SUCCESS</CODE> を返します。
一冊でも初期化に失敗した場合は、残りの副本の初期化を諦め、原因を示す
エラーコードを返します。
</P><P>

<VAR>book</VAR> は、あらかじめ書籍に結び付けられていなくてはなりません。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOK</CODE> を返します。
</P><P>

この関数を呼び出すと、<VAR>book</VAR> は、副本を選択していない状態になります。
</DL>
</P><P>

<A NAME="IDX181"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_subbook_list</B> <I>(EB_Book *<VAR>book</VAR>, EB_Subbook_Code *<VAR>subbook_list</VAR>, int *<VAR>subbook_count</VAR>)</I>
<DD><A NAME="IDX182"></A>
<A NAME="IDX183"></A>
</P><P>

関数 <CODE>eb_subbook_list()</CODE> は、<VAR>book</VAR> 内のすべて副本の副本コードを
<CODE>EB_Subbook_Code</CODE> 型の配列にして、<VAR>subbook_list</VAR> の指す領域に
書き込みます。
配列は、最大で <CODE>EB_MAX_SUBBOOKS</CODE> 個の要素を持ちます。
加えて、書籍が収録している副本の個数を <VAR>subbook_count</VAR> の指す領域に
書き込みます。
</P><P>

成功すると、関数は <CODE>EB_SUCCESS</CODE> を返します。
失敗すると、<VAR>subbook_count</VAR> の指す領域に 0 を書き込み、原因を示す
エラーコードを返します。
</P><P>

<VAR>book</VAR> は、あらかじめ書籍に結び付けられていなくてはなりません。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOK</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX184"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_subbook</B> <I>(EB_Book *<VAR>book</VAR>, EB_Subbook_Code *<VAR>subbook_code</VAR>)</I>
<DD><A NAME="IDX185"></A>
</P><P>

関数 <CODE>eb_subbook()</CODE> は、<VAR>book</VAR> が選択中の副本の副本コードを
<VAR>subbook_code</VAR> の指す領域に書き込みます。
</P><P>

成功すると、関数は <CODE>EB_SUCCESS</CODE> を返します。
失敗すると、<VAR>subbook_code</VAR> の指す領域に <CODE>EB_SUBBOOK_INVALID</CODE> 
を書き込み、原因を示すエラーコードを返します。
</P><P>

あらかじめ、<VAR>book</VAR> はいずれかの副本を選択していなくてはなりません。
選択していない場合は、<CODE>EB_ERR_NO_CUR_SUB</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX186"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_subbook_title</B> <I>(EB_Book *<VAR>book</VAR>, char *<VAR>title</VAR>)</I>
<DD><A NAME="IDX187"></A>
<A NAME="IDX188"></A>
</P><P>

関数 <CODE>eb_subbook_title()</CODE> は、<VAR>book</VAR> が選択中の副本の題名を
<VAR>title</VAR> の指す領域に文字列として書き込みます。
題名の文字列の長さは、最長で <CODE>EB_MAX_TITLE_LENGTH</CODE> バイトです。
この長さは、末尾のナル文字を含みません。
</P><P>

書籍の文字コード
(「<A HREF="eb-ja_5.html#SEC21">[CD-ROM 書籍と <CODE>EB_Book</CODE> オブジェクト] データ型の詳細</A>」節を参照)
が <CODE>EB_CHARCODE_ISO8859_1</CODE> なら、題名を表す文字列は ISO 8859-1 に
なり、それ以外の文字コードなら日本語 EUC になります。
</P><P>

成功すると、関数は <CODE>EB_SUCCESS</CODE> を返します。
失敗すると、<VAR>title</VAR> の指す領域に空文字列を書き込み、原因を示す
エラーコードを返します。
</P><P>

あらかじめ、<VAR>book</VAR> 内のいずれかの副本が選択されていなくてはなりません。
選択していない場合は、<CODE>EB_ERR_NO_CUR_SUB</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX189"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_subbook_title2</B> <I>(EB_Book *<VAR>book</VAR>, EB_Subbook_Code <VAR>subbook_code</VAR>, char *<VAR>title</VAR>)</I>
<DD><A NAME="IDX190"></A>
</P><P>

<CODE>eb_subbook_title()</CODE> と似ていますが、選択中の副本ではなく、引数
<VAR>subbook_code</VAR> で指定された副本の題名を書き込む点が異なります。
</P><P>

<VAR>book</VAR> は副本を選択していなくても構いませんが、あらかじめ
書籍に結び付けられていなければなりません。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOK</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX191"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_subbook_directory</B> <I>(EB_Book *<VAR>book</VAR>, char *<VAR>directory</VAR>)</I>
<DD><A NAME="IDX192"></A>
<A NAME="IDX193"></A>
</P><P>

関数 <CODE>eb_subbook_directory()</CODE> は、<VAR>book</VAR> 内で現在選択中の副本
のデータファイルを収めたディレクトリ名を、<VAR>directory</VAR> の指す領域に
書き込みます。
</P><P>

ディレクトリ名の文字列の長さは、最長で <CODE>EB_MAX_DIRECTORY_NAME_LENGTH</CODE>
バイトです。
この長さに、末尾のナル文字は含みません。
ディレクトリ名は ASCII の数字、英小文字、アンダースコアで構成されます。
</P><P>

成功すると、関数は <CODE>EB_SUCCESS</CODE> を返します。
失敗すると、<VAR>directory</VAR> の指す領域に空文字列を書き込み、原因に
を示すエラーコードを返します。
</P><P>

あらかじめ、<VAR>book</VAR> 内のいずれかの副本が選択されていなくてはなりません。
選択していない場合は、<CODE>EB_ERR_NO_CUR_SUB</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX194"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_subbook_directory2</B> <I>(EB_Book *<VAR>book</VAR>, EB_Subbook_Code <VAR>subbook_code</VAR>, char *<VAR>directory</VAR>)</I>
<DD><A NAME="IDX195"></A>
</P><P>

<CODE>eb_subbook_directory()</CODE> と似ていますが、選択中の副本ではなく、引数
<VAR>subbook_code</VAR> で指定された副本のディレクトリ名を書き込む点が
異なります。
</P><P>

<VAR>book</VAR> は副本を選択していなくても構いませんが、あらかじめ
書籍に結び付けられていなければなりません。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOK</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX196"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_set_subbook</B> <I>(EB_Book *<VAR>book</VAR>, EB_Subbook_Code <VAR>code</VAR>)</I>
<DD><A NAME="IDX197"></A>
</P><P>

関数 <CODE>eb_set_subbook()</CODE> は、<VAR>book</VAR> の副本 <VAR>code</VAR> を選択
します。
すでに副本を選択していた場合は、いったん未選択の状態にしてから副本
<VAR>subbook_code</VAR> を選択します。
</P><P>

成功すると、関数は <CODE>EB_SUCCESS</CODE> を返します。
このとき、外字は未選択の状態となり、検索、テキストデータの読み込み、
バイナリデータの読み込みについての状態記録は、すべてリセットされます。
失敗すると、副本を未選択の状態にして、原因を示すエラーコードを返します。
</P><P>

あらかじめ、<VAR>book</VAR> は書籍に結び付けられていなければなりません。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOK</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX198"></A>
<DL>
<DT><U>Function:</U> void <B>eb_unset_subbook</B> <I>(EB_Book *<VAR>book</VAR>)</I>
<DD><A NAME="IDX199"></A>
</P><P>

関数 <CODE>eb_unset_subbook()</CODE> は、<VAR>book</VAR> が選択している副本を未選択
の状態にします。
<VAR>book</VAR> が書籍に結び付いていないか、副本が選択されていない場合は、何
もしません。
</DL>
</P><P>

<A NAME="Search"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_7.html#SEC29"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_8.html#SEC35"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated
by <I>Motoyuki Kasahara</I> on <I>December, 28  2003</I>
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
