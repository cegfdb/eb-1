<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on December, 28  2003 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>EB Library: Book List on Server</TITLE>

<META NAME="description" CONTENT="EB Library: Book List on Server">
<META NAME="keywords" CONTENT="EB Library: Book List on Server">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="EN" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC85"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_12.html#SEC84"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC86"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_12.html#SEC77"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 13. サーバ上の書籍一覧 </H1>
<!--docid::SEC85::-->
<P>

EBNET サーバから遠隔アクセスを行う際、サーバがそのクライアントに対して
アクセスを許可している書籍や appendix データの一覧を取得することが
できます。
</P><P>

このとき、EBNET サーバを指定する遠隔アクセス記述子には、特定の書籍や
appendix データに対するアクセスとは異なり、書籍名は指定しません。
すなわち、一般形は次のようになります。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>ebnet://<VAR>ホスト</VAR>:<VAR>ポート</VAR>/
</pre></td></tr></table></P><P>

末尾の `/' はなくても構いません。
<SAMP>`:'</SAMP> とそれに続くポート番号は省略可能で、その場合は 22010 番ポート
を利用することを意味します。
</P><P>

ebinfo コマンドの --book-list オプション指定時の挙動は、EB ライブラリ
のこの機能によって実装されています。
(ebinfo についての詳細は、
<CITE>ebinfo-ja</CITE> の「EBNET サーバの書籍一覧」節を参照。)
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>% ebinfo --book-list ebnet://localhost
名前             題名
encycl           ブラウンコンサイス百科事典
encycl.app       ブラウンコンサイス百科事典 (appendix)
crossword        クロスワードパズル辞典
travel           ワールドトラベルガイド
</pre></td></tr></table></P><P>

名前の末尾が <SAMP>`.app'</SAMP> になっているものは appendix データで、その他
は書籍本体です。
この例の書籍 <SAMP>`encycl'</SAMP> に対してアクセスするなら、遠隔アクセス識別子
は <CODE>ebnet://localhost/encycl</CODE> になります。
</P><P>

なお、クライアントに対してアクセスを許可していない書籍や appendix データ
は、サーが側で一覧から除外されます。
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_13.html#SEC86">13.1 <CODE>EB_BookList</CODE> オブジェクト</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_13.html#SEC87">13.2 データ型の詳細</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_13.html#SEC88">13.3 関数の詳細</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="eb-ja_13.html#SEC89">13.4 サンプルプログラム</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="EB_BookList Object"></A>
<HR SIZE="6">
<A NAME="SEC86"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC87"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 13.1 <CODE>EB_BookList</CODE> オブジェクト </H2>
<!--docid::SEC86::-->
<P>

EBNET サーバの提供する書籍および appendix データの一覧を取得するには、
まず <CODE>EB_BookList</CODE> 型のオブジェクトを用意する必要があります。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>EB_BookList bl;
</pre></td></tr></table></P><P>

オブジェクトの領域は、<CODE>malloc()</CODE> で確保しても構いません。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>EB_BookList *bl_pointer;

bl_pointer = (EB_BookList *) malloc(sizeof(EB_BookList));
</pre></td></tr></table></P><P>

<CODE>EB_Book</CODE> オブジェクトと同様に、<CODE>EB_BookList</CODE> オブジェクトも
使う前に中身を初期化する必要があります。
これは、<CODE>eb_initialize_booklist()</CODE> という関数で行います。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>eb_initialize_booklist(&#38;bl);
eb_initialize_booklist(bl_pointer);
</pre></td></tr></table></P><P>

初期化が完了したら、特定のサーバとオブジェクトを結びつけます。
たとえば、<CODE>ebnet://localhost</CODE> で表されるサーバに対して、オブジェクト
を結びつけるには次のようにします。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>if (eb_bind_booklist(&#38;bl, "ebnet://localhost") != EB_SUCCESS) {
    printf("eb_bind_booklist() failed\n");
    return;
}
</pre></td></tr></table></P><P>

これはちょうど、<CODE>EB_Book</CODE> オブジェクトに対して <CODE>eb_bind()</CODE>
を呼ぶのと同じです。
</P><P>

こうして、ようやく書籍一覧の情報を取り出すことができます。
これには <CODE>eb_booklist_book_count()</CODE>, <CODE>eb_booklist_book_name()</CODE>, 
<CODE>eb_booklist_book_title()</CODE> という 3 つの関数を使用します。
これらの関数はそれぞれ、クライアントがアクセス可能な書籍の数、各書籍
および appendix データの名称 (アクセス識別子として指定する名前)、
各書籍と appendix データの題名を得ることができます。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>char *name, *title;
int count, i;

count = eb_booklist_book_count(&#38;bl);
for (i = 0; i &#60; count; i++) {
    if (eb_booklist_book_name(&#38;bl, i, &#38;name) != EB_SUCCESS) {
        printf("eb_booklist_book_name(%d) failed\n", i);
        return;
    }
    if (eb_booklist_book_title(&#38;bl, i, &#38;title) != EB_SUCCESS) {
        printf("eb_booklist_book_title(%d) failed\n", i);
        return;
    }
    printf("name = %s, title = %s\n", name, title);
}
</pre></td></tr></table></P><P>

<CODE>EB_BookList</CODE> オブジェクトを使い終わったら、必ず後始末を行います。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>eb_finalize_booklist(&#38;bl);
eb_finalize_booklist(bl_pointer);
</pre></td></tr></table></P><P>

オブジェクトの領域を <CODE>malloc()</CODE> で確保した場合は、
<CODE>eb_finalize_booklist()</CODE> を呼んだ後ならば、オブジェクトの領域を
安全に解放することができます。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>free(bl_pointer);
</pre></td></tr></table></P><P>

<A NAME="BookList Data"></A>
<HR SIZE="6">
<A NAME="SEC87"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC86"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC88"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 13.2 データ型の詳細 </H2>
<!--docid::SEC87::-->
<P>

この節で説明しているデータ型を使うには、次のようにヘッダファイルを
読み込んで下さい。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#include &#60;eb/booklist.h&#62;
</pre></td></tr></table></P><P>

<A NAME="IDX660"></A>
<DL>
<DT><U>Data type:</U> <B>EB_BookList</B>
<DD><A NAME="IDX661"></A>
</P><P>

<CODE>EB_BookList</CODE> 型は、EBNET サーバ上が使っている書籍および appendix
の一覧を取得する際に用いるオクジェクトの型です。
</P><P>

<CODE>EB_BookList</CODE> オブジェクトを使用する際は、まずそのオブジェクトに
対して <CODE>eb_initialize_booklist()</CODE> を呼んで初期化する必要があります。
</DL>
</P><P>

<A NAME="BookList Functions"></A>
<HR SIZE="6">
<A NAME="SEC88"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC87"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC89"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 13.3 関数の詳細 </H2>
<!--docid::SEC88::-->
<P>

この節で説明している関数を使うには、次のようにヘッダファイルを読み込んで
下さい。
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>#include &#60;eb/booklist.h&#62;
</pre></td></tr></table></P><P>

<A NAME="IDX662"></A>
<DL>
<DT><U>Function:</U> void <B>eb_initialize_booklist</B> <I>(EB_BookList *<VAR>bl</VAR>)</I>
<DD><A NAME="IDX663"></A>
</P><P>

関数 <CODE>eb_initialize_booklist()</CODE> は、<VAR>bl</VAR> の指す
<CODE>EB_BookList</CODE> オブジェクトを初期化します。
<CODE>EB_BookList</CODE> オブジェクトに対して EB ライブラリの他の関数を呼ぶ
前に、必ずそのオブジェクトを初期化しなくてはなりません。
初期化していないオブジェクトに対して、EB ライブラリの他の関数を呼んだ
場合の動作は未定義です。
また、すでに初期化したオブジェクトに対して、
再度 <CODE>eb_initialize_booklist()</CODE> を呼んではいけません。
呼んだ場合の動作は未定義です。
</DL>
</P><P>

<A NAME="IDX664"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_bind_booklist</B> <I>(EB_BookList *<VAR>bl</VAR>, const char *<VAR>path</VAR>)</I>
<DD><A NAME="IDX665"></A>
</P><P>

関数 <CODE>eb_bind_booklist()</CODE> は、<VAR>app</VAR> の指す
<CODE>EB_BookList</CODE> オブジェクトを、遠隔アクセス記述子 <VAR>path</VAR> で指定
された EBNET サーバに結び付けます。
</P><P>

オブジェクトがすでにサーバに結び付いていた場合、そのサーバとの結び付き
を解いてから、<VAR>path</VAR> にあるサーバに結び付けます。
</P><P>

成功すると、関数は <CODE>EB_SUCCESS</CODE> を返します。
失敗すると、オブジェクトをサーバとの結び付きを解かれた状態にして、原因
を示すエラーコードを返します。
</P><P>

<VAR>path</VAR> は、<CODE>EB_MAX_PATH_LENGTH</CODE> バイトに収まていなくては
なりません。
これを超えると、<CODE>EB_ERR_TOO_LONG_FILE_NAME</CODE> を返します。
また、書籍名を指定していない遠隔アクセス記述子でなければなりません。
それ以外の形式だと、<CODE>EB_ERR_BAD_FILE_NAME</CODE> を返します。
</P><P>

使用している EB ライブラリのバイナリが、遠隔アクセスに非対応のもので
ある場合、<CODE>EB_ERR_EBNET_UNSUPPORTED</CODE> が返ります。
</DL>
</P><P>

<A NAME="IDX666"></A>
<DL>
<DT><U>Function:</U> void <B>eb_finalize_booklist</B> <I>(EB_BookList *<VAR>bl</VAR>)</I>
<DD><A NAME="IDX667"></A>
</P><P>

関数 <CODE>eb_finalize_booklist()</CODE> は、<VAR>bl</VAR> が指す <CODE>EB_BookList</CODE>
オブジェクトの後始末を行います。
</P><P>

オブジェクトが割り当てて管理していたメモリはすべて解放され、
ファイルディスクリプタもすべて閉じられます。
オブジェクトが EBNET サーバと結び付いていた場合は、結び付きが解かれます。
</P><P>

後始末をしたオブジェクトに対して <CODE>eb_bind_booklist()</CODE> を呼ぶことで、
オブジェクトを再利用することができます。
</DL>
</P><P>

<A NAME="IDX668"></A>
<DL>
<DT><U>Function:</U> int <B>eb_booklist_book_count</B> <I>(EB_BookList *<VAR>bl</VAR>)</I>
<DD><A NAME="IDX669"></A>
</P><P>

関数 <CODE>eb_booklist_book_count()</CODE> は、EBNET サーバがこのクライアント
に対してアクセスを許可している書籍および appendix データの数を取得します。
</P><P>

オブジェクト <VAR>bl</VAR> の指す <CODE>EB_BookList</CODE> オブジェクトは、
あらかじめ EBNET サーバに結びついている必要があります。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOKLIST</CODE> を返します。
</DL>
</P><P>

<A NAME="IDX670"></A>
<DL>
<DT><U>Function:</U> EB_Error_Code <B>eb_booklist_book_name</B> <I>(EB_BookList *<VAR>bl</VAR>, int <VAR>i</VAR>, char **<VAR>name</VAR>)</I>
<DD><A NAME="IDX671"></A>
<DT><U>Function:</U> EB_Error_Code <B>eb_booklist_book_title</B> <I>(EB_BookList *<VAR>bl</VAR>, int <VAR>i</VAR>, char **<VAR>title</VAR>)</I>
<DD><A NAME="IDX672"></A>
<A NAME="IDX673"></A>
</P><P>

関数 <CODE>eb_booklist_book_name()</CODE> は、EBNET サーバの書籍や
appendix データの名称を取得します。
ここで言う「名称」とは、遠隔アクセス識別子で指定する書籍名のことです。
つまり、<SAMP>`ebnet://localhost/dict'</SAMP> の <SAMP>`dict'</SAMP> の部分を指します。
同様に、関数 <CODE>eb_booklist_book_title()</CODE> は、書籍や appendix の題名
を取得します。
</P><P>

いずれの関数も、EBNET サーバ上の何番目の書籍もしくは appendix の情報を
取得するのかを、引数 <VAR>i</VAR> で指定します。
先頭は 1 番目ではなく 0 番目になります。
</P><P>

成功すると、関数は書籍の名称、題名へのポインタを *<VAR>name</VAR>, *<VAR>title</VAR>
に書き込み、<CODE>EB_SUCCESS</CODE> を返します。
なお、このポインタ値は オブジェクト <CODE>bl</CODE> が保持している文字列を指す
ようになっています。
<CODE>bl</CODE> に対して <CODE>eb_finalize_booklist()</CODE> を呼んでしまうと、この
文字列も参照不可能になってしまいますので、注意して下さい。
</P><P>

オブジェクト <VAR>bl</VAR> の指す <CODE>EB_BookList</CODE> オブジェクトは、
あらかじめ EBNET サーバに結びついている必要があります。
結びついていない場合は、<CODE>EB_ERR_UNBOUND_BOOKLIST</CODE> を返します。
また、<VAR>i</VAR> は 0 以上かつサーバが提供している書籍および appendix の
総数未満でなければなりません。
これ以外の値のときは、<CODE>EB_ERR_NO_SUCH_BOOK</CODE> が返ります。
</DL>
</P><P>

<A NAME="BookList Sample"></A>
<HR SIZE="6">
<A NAME="SEC89"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC88"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 13.4 サンプルプログラム </H2>
<!--docid::SEC89::-->
<P>

<A NAME="IDX674"></A>
<TABLE><tr><td>&nbsp;</td><td class=example><pre>/*
 * 使用方法:
 *     booklist &#60;remote-access-ideintifier&#62;
 * 例:
 *     booklist ebnet://localhost
 * 説明:
 *     &#60;remote-access-ideintifier&#62; で指定した EBNET サーバに接続し
 *     て、サーバの提供する書籍、appendix の一覧を表示します。
 */
#include "config.h"

#include &#60;stdio.h&#62;
#include &#60;stdlib.h&#62;

#include &#60;eb/eb.h&#62;
#include &#60;eb/error.h&#62;
#include &#60;eb/booklist.h&#62;

int
main(argc, argv)
    int argc;
    char *argv[];
{
    EB_Error_Code error_code;
    EB_BookList bl;
    int book_count;
    char *name, *title;
    int i;

    /* コマンド行引数をチェック。*/
    if (argc != 2) {
        fprintf(stderr, "Usage: %s book-path remote-access-identifier\n",
            argv[0]);
        exit(1);
    }

    /* EB ライブラリと `bl' を初期化。*/
    eb_initialize_library();
    eb_initialize_booklist(&#38;bl);

    /* EBNET サーバを `bl' に結び付ける。*/
    error_code = eb_bind_booklist(&#38;bl, argv[1]);
    if (error_code != EB_SUCCESS) {
        fprintf(stderr, "%s: failed to bind the EBNET server, %s: %s\n",
            argv[0], eb_error_message(error_code), argv[1]);
        goto die;
    }

    /* サーバ上の書籍、appendix の個数を取得。*/
    error_code = eb_booklist_book_count(&#38;bl, &#38;book_count);
    if (error_code != EB_SUCCESS) {
        fprintf(stderr, "%s: failed to get the number of books, %s\n",
            argv[0], eb_error_message(error_code));
        goto die;
    }

    for (i = 0; i &#60; book_count; i++) {
        /* 書籍、appendix の名称を取得。*/
        error_code = eb_booklist_book_name(&#38;bl, i, &#38;name);
        if (error_code != EB_SUCCESS) {
            fprintf(stderr, "%s: failed to get book name #%d, %s\n",
                argv[0], i, eb_error_message(error_code));
            goto die;
        }

            }
        /* 書籍、appendix の題名を取得。*/
        error_code = eb_booklist_book_name(&#38;bl, i, &#38;title);
        if (error_code != EB_SUCCESS) {
            fprintf(stderr, "%s: failed to get book title #%d, %s\n",
                argv[0], i, eb_error_message(error_code));
            goto die;
        }

        printf("%-20s  %s\n", name, title);
    }
        
    /* `bl' と EB ライブラリの利用を終了。*/
    eb_finalize_book(&#38;bl);
    eb_finalize_library();
    exit(0);

    /* エラー発生で終了するときの処理。*/
  die:
    eb_finalize_book(&#38;bl);
    eb_finalize_library();
    exit(1);
}
</pre></td></tr></table></P><P>

<A NAME="Indice"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_13.html#SEC85"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_14.html#SEC90"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="eb-ja_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated
by <I>Motoyuki Kasahara</I> on <I>December, 28  2003</I>
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
